2025-04-25 00:03:46,783 - config_manager - INFO - Đã tải cấu hình mặc định
2025-04-25 00:03:56,184 - test_autobkp - ERROR - Lỗi khi import các module: cannot import name 'train_customer_model' from 'app.scripts.train' (D:\Python\AutoBKP_V2\app\scripts\train.py)
2025-04-25 00:03:56,187 - test_autobkp - INFO - Đã khởi tạo AutoBKPTester với customer_id: test_customer
2025-04-25 00:03:56,187 - test_autobkp - INFO - Thư mục tạm: C:\Users\trant\AppData\Local\Temp\autobkp_test_71j14pf9
2025-04-25 00:03:56,188 - test_autobkp - INFO - === BẮT ĐẦU CHẠY TẤT CẢ CÁC BÀI KIỂM TRA ===
2025-04-25 00:03:56,188 - test_autobkp - INFO - Bắt đầu kiểm tra cấu hình...
2025-04-25 00:03:56,188 - test_autobkp - ERROR - Không thể import các module cần thiết
2025-04-25 00:03:56,189 - test_autobkp - ERROR - ✗ Kiểm tra cấu hình thất bại
2025-04-25 00:03:56,189 - test_autobkp - WARNING - Dừng các bài kiểm tra tiếp theo
2025-04-25 00:27:46,287 - config_manager - INFO - Đã tải cấu hình mặc định
2025-04-25 00:27:47,478 - test_autobkp - INFO - Đã khởi tạo AutoBKPTester với customer_id: test_customer
2025-04-25 00:27:47,478 - test_autobkp - INFO - Thư mục tạm: C:\Users\trant\AppData\Local\Temp\autobkp_test_ltfkzh99
2025-04-25 00:27:47,478 - test_autobkp - INFO - === BẮT ĐẦU CHẠY TẤT CẢ CÁC BÀI KIỂM TRA ===
2025-04-25 00:27:47,478 - test_autobkp - INFO - Bắt đầu kiểm tra cấu hình...
2025-04-25 00:27:47,478 - test_autobkp - INFO - Đã tải cấu hình mặc định thành công
2025-04-25 00:27:47,479 - config_manager - INFO - Tạo cấu hình mới cho khách hàng test_customer
2025-04-25 00:27:47,480 - config_manager - INFO - Đã lưu cấu hình cho khách hàng test_customer
2025-04-25 00:27:47,480 - test_autobkp - INFO - Đã tải cấu hình khách hàng test_customer thành công
2025-04-25 00:27:47,480 - test_autobkp - INFO - Kiểm tra cấu hình thành công
2025-04-25 00:27:47,480 - test_autobkp - INFO - ✓ Kiểm tra cấu hình thành công
2025-04-25 00:27:47,480 - test_autobkp - INFO - Bắt đầu tạo 100 dòng dữ liệu mẫu...
2025-04-25 00:27:47,483 - test_autobkp - INFO - Đã tạo dữ liệu mẫu và lưu vào: C:\Users\trant\AppData\Local\Temp\autobkp_test_ltfkzh99\test_customer_sample_data.csv
2025-04-25 00:27:47,483 - test_autobkp - INFO - ✓ Tạo dữ liệu mẫu thành công
2025-04-25 00:27:47,483 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng validate_data...
2025-04-25 00:27:47,484 - validate_data - INFO - Bắt đầu kiểm tra tính hợp lệ của dữ liệu từ file C:\Users\trant\AppData\Local\Temp\autobkp_test_ltfkzh99\test_customer_sample_data.csv
2025-04-25 00:27:47,510 - validate_data - INFO - Đã đọc file CSV với encoding utf-8
2025-04-25 00:27:47,532 - validate_data - INFO - Hoàn tất kiểm tra. Trạng thái: valid
2025-04-25 00:27:47,533 - validate_data - INFO - Tổng số cảnh báo: 0
2025-04-25 00:27:47,533 - test_autobkp - INFO - Kết quả validate: valid
2025-04-25 00:27:47,534 - test_autobkp - ERROR - Lỗi khi kiểm tra chức năng validate_data: Object of type bool is not JSON serializable
Traceback (most recent call last):
  File "D:\Python\AutoBKP_V2\test_autobkp.py", line 287, in test_validate_data
    json.dump(result, f, ensure_ascii=False, indent=2)
  File "C:\Users\trant\AppData\Local\Programs\Python\Python312\Lib\json\__init__.py", line 179, in dump
    for chunk in iterable:
  File "C:\Users\trant\AppData\Local\Programs\Python\Python312\Lib\json\encoder.py", line 432, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "C:\Users\trant\AppData\Local\Programs\Python\Python312\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\trant\AppData\Local\Programs\Python\Python312\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\trant\AppData\Local\Programs\Python\Python312\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\trant\AppData\Local\Programs\Python\Python312\Lib\json\encoder.py", line 439, in _iterencode
    o = _default(o)
        ^^^^^^^^^^^
  File "C:\Users\trant\AppData\Local\Programs\Python\Python312\Lib\json\encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type bool is not JSON serializable
2025-04-25 00:27:47,579 - test_autobkp - ERROR - ✗ Kiểm tra chức năng validate_data thất bại
2025-04-25 00:27:47,580 - test_autobkp - WARNING - Dừng các bài kiểm tra tiếp theo
2025-04-25 00:33:48,714 - config_manager - INFO - Đã tải cấu hình mặc định
2025-04-25 00:33:49,811 - test_autobkp - INFO - Đã khởi tạo AutoBKPTester với customer_id: test_customer
2025-04-25 00:33:49,811 - test_autobkp - INFO - Thư mục tạm: C:\Users\trant\AppData\Local\Temp\autobkp_test_0_9qy3mj
2025-04-25 00:33:49,811 - test_autobkp - INFO - === BẮT ĐẦU CHẠY TẤT CẢ CÁC BÀI KIỂM TRA ===
2025-04-25 00:33:49,811 - test_autobkp - INFO - Bắt đầu kiểm tra cấu hình...
2025-04-25 00:33:49,811 - test_autobkp - INFO - Đã tải cấu hình mặc định thành công
2025-04-25 00:33:49,813 - test_autobkp - INFO - Đã tải cấu hình khách hàng test_customer thành công
2025-04-25 00:33:49,813 - test_autobkp - INFO - Kiểm tra cấu hình thành công
2025-04-25 00:33:49,813 - test_autobkp - INFO - ✓ Kiểm tra cấu hình thành công
2025-04-25 00:33:49,813 - test_autobkp - INFO - Bắt đầu tạo 100 dòng dữ liệu mẫu...
2025-04-25 00:33:49,816 - test_autobkp - INFO - Đã tạo dữ liệu mẫu và lưu vào: C:\Users\trant\AppData\Local\Temp\autobkp_test_0_9qy3mj\test_customer_sample_data.csv
2025-04-25 00:33:49,816 - test_autobkp - INFO - ✓ Tạo dữ liệu mẫu thành công
2025-04-25 00:33:49,816 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng validate_data...
2025-04-25 00:33:49,816 - validate_data - INFO - Bắt đầu kiểm tra tính hợp lệ của dữ liệu từ file C:\Users\trant\AppData\Local\Temp\autobkp_test_0_9qy3mj\test_customer_sample_data.csv
2025-04-25 00:33:49,851 - validate_data - INFO - Đã đọc file CSV với encoding utf-8
2025-04-25 00:33:49,855 - validate_data - INFO - Hoàn tất kiểm tra. Trạng thái: valid
2025-04-25 00:33:49,855 - validate_data - INFO - Tổng số cảnh báo: 0
2025-04-25 00:33:49,856 - test_autobkp - INFO - Kết quả validate: valid
2025-04-25 00:33:49,856 - test_autobkp - ERROR - Lỗi khi kiểm tra chức năng validate_data: Type <class 'numpy.bool'> not serializable
Traceback (most recent call last):
  File "D:\Python\AutoBKP_V2\test_autobkp.py", line 302, in test_validate_data
    json.dump(result, f, ensure_ascii=False, indent=2, default=json_serializable)
  File "C:\Users\trant\AppData\Local\Programs\Python\Python312\Lib\json\__init__.py", line 179, in dump
    for chunk in iterable:
  File "C:\Users\trant\AppData\Local\Programs\Python\Python312\Lib\json\encoder.py", line 432, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "C:\Users\trant\AppData\Local\Programs\Python\Python312\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\trant\AppData\Local\Programs\Python\Python312\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\trant\AppData\Local\Programs\Python\Python312\Lib\json\encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "C:\Users\trant\AppData\Local\Programs\Python\Python312\Lib\json\encoder.py", line 439, in _iterencode
    o = _default(o)
        ^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\test_autobkp.py", line 298, in json_serializable
    raise TypeError(f"Type {type(obj)} not serializable")
TypeError: Type <class 'numpy.bool'> not serializable
2025-04-25 00:33:49,858 - test_autobkp - ERROR - ✗ Kiểm tra chức năng validate_data thất bại
2025-04-25 00:33:49,858 - test_autobkp - WARNING - Dừng các bài kiểm tra tiếp theo
2025-04-25 00:36:15,350 - config_manager - INFO - Đã tải cấu hình mặc định
2025-04-25 00:36:16,498 - test_autobkp - INFO - Đã khởi tạo AutoBKPTester với customer_id: test_customer
2025-04-25 00:36:16,500 - test_autobkp - INFO - Thư mục tạm: C:\Users\trant\AppData\Local\Temp\autobkp_test_ii8gvhk5
2025-04-25 00:36:16,500 - test_autobkp - INFO - === BẮT ĐẦU CHẠY TẤT CẢ CÁC BÀI KIỂM TRA ===
2025-04-25 00:36:16,500 - test_autobkp - INFO - Bắt đầu kiểm tra cấu hình...
2025-04-25 00:36:16,500 - test_autobkp - INFO - Đã tải cấu hình mặc định thành công
2025-04-25 00:36:16,501 - test_autobkp - INFO - Đã tải cấu hình khách hàng test_customer thành công
2025-04-25 00:36:16,501 - test_autobkp - INFO - Kiểm tra cấu hình thành công
2025-04-25 00:36:16,501 - test_autobkp - INFO - ✓ Kiểm tra cấu hình thành công
2025-04-25 00:36:16,501 - test_autobkp - INFO - Bắt đầu tạo 100 dòng dữ liệu mẫu...
2025-04-25 00:36:16,504 - test_autobkp - INFO - Đã tạo dữ liệu mẫu và lưu vào: C:\Users\trant\AppData\Local\Temp\autobkp_test_ii8gvhk5\test_customer_sample_data.csv
2025-04-25 00:36:16,504 - test_autobkp - INFO - ✓ Tạo dữ liệu mẫu thành công
2025-04-25 00:36:16,504 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng validate_data...
2025-04-25 00:36:16,504 - validate_data - INFO - Bắt đầu kiểm tra tính hợp lệ của dữ liệu từ file C:\Users\trant\AppData\Local\Temp\autobkp_test_ii8gvhk5\test_customer_sample_data.csv
2025-04-25 00:36:16,533 - validate_data - INFO - Đã đọc file CSV với encoding utf-8
2025-04-25 00:36:16,538 - validate_data - INFO - Hoàn tất kiểm tra. Trạng thái: valid
2025-04-25 00:36:16,538 - validate_data - INFO - Tổng số cảnh báo: 0
2025-04-25 00:36:16,539 - test_autobkp - INFO - Kết quả validate: valid
2025-04-25 00:36:16,539 - test_autobkp - INFO - Đã lưu kết quả validate vào: C:\Users\trant\AppData\Local\Temp\autobkp_test_ii8gvhk5\validate_result.json
2025-04-25 00:36:16,539 - test_autobkp - INFO - Kiểm tra chức năng validate_data thành công
2025-04-25 00:36:16,539 - test_autobkp - INFO - ✓ Kiểm tra chức năng validate_data thành công
2025-04-25 00:36:16,539 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng tiền xử lý dữ liệu...
2025-04-25 00:36:16,539 - preprocess - INFO - Bắt đầu tiền xử lý dữ liệu cho khách hàng test_customer
2025-04-25 00:36:16,541 - preprocess - INFO - Đọc dữ liệu từ: C:\Users\trant\AppData\Local\Temp\autobkp_test_ii8gvhk5\test_customer_sample_data.csv
2025-04-25 00:36:16,542 - preprocess - INFO - Đọc thành công với encoding: utf-8
2025-04-25 00:36:16,543 - preprocess - INFO - Đã đọc 100 dòng dữ liệu từ C:\Users\trant\AppData\Local\Temp\autobkp_test_ii8gvhk5\test_customer_sample_data.csv
2025-04-25 00:36:16,543 - preprocess - INFO - Tiền xử lý cột văn bản tiếng Việt: TenHangHoaDichVu
2025-04-25 00:36:16,546 - preprocess - INFO - Tiền xử lý cột ID: MSTNguoiBan
2025-04-25 00:36:16,547 - preprocess - INFO - Phân tích phân phối của biến mục tiêu: HachToan
2025-04-25 00:36:16,548 - preprocess - INFO - Số lượng lớp: 15
2025-04-25 00:36:16,548 - preprocess - INFO - Tỷ lệ mất cân bằng: 2.50
2025-04-25 00:36:16,548 - preprocess - INFO - Lớp hiếm nhất có 4 mẫu (4.00%)
2025-04-25 00:36:16,548 - preprocess - INFO - Lớp phổ biến nhất có 10 mẫu (10.00%)
2025-04-25 00:36:16,549 - preprocess - INFO - Phân tích phân phối của biến mục tiêu: MaHangHoa
2025-04-25 00:36:16,549 - preprocess - INFO - Số lượng lớp: 10
2025-04-25 00:36:16,551 - preprocess - INFO - Tỷ lệ mất cân bằng: 7.00
2025-04-25 00:36:16,551 - preprocess - INFO - Lớp hiếm nhất có 1 mẫu (2.56%)
2025-04-25 00:36:16,551 - preprocess - INFO - Lớp phổ biến nhất có 7 mẫu (17.95%)
2025-04-25 00:36:16,551 - preprocess - INFO - Phân chia dữ liệu với test_size=0.2
2025-04-25 00:36:16,552 - preprocess - INFO - Tập huấn luyện: 80 mẫu
2025-04-25 00:36:16,552 - preprocess - INFO - Tập kiểm tra: 20 mẫu
2025-04-25 00:36:16,556 - preprocess - INFO - Đã lưu tập huấn luyện: C:\Users\trant\AppData\Local\Temp\autobkp_test_ii8gvhk5\test_customer_train_20250425_003616.csv
2025-04-25 00:36:16,557 - preprocess - INFO - Đã lưu tập kiểm tra: C:\Users\trant\AppData\Local\Temp\autobkp_test_ii8gvhk5\test_customer_test_20250425_003616.csv
2025-04-25 00:36:16,557 - app.config.utils - INFO - Đã lưu metadata tại: C:\Users\trant\AppData\Local\Temp\autobkp_test_ii8gvhk5\test_customer_metadata_20250425_003616.json
2025-04-25 00:36:16,557 - preprocess - INFO - Đã lưu metadata: C:\Users\trant\AppData\Local\Temp\autobkp_test_ii8gvhk5\test_customer_metadata_20250425_003616.json
2025-04-25 00:36:16,557 - test_autobkp - INFO - Đã tiền xử lý dữ liệu thành công
2025-04-25 00:36:16,559 - test_autobkp - INFO - - Tập huấn luyện: C:\Users\trant\AppData\Local\Temp\autobkp_test_ii8gvhk5\test_customer_train_20250425_003616.csv
2025-04-25 00:36:16,559 - test_autobkp - INFO - - Tập kiểm tra: C:\Users\trant\AppData\Local\Temp\autobkp_test_ii8gvhk5\test_customer_test_20250425_003616.csv
2025-04-25 00:36:16,603 - test_autobkp - INFO - Số lượng mẫu trong tập huấn luyện: 80
2025-04-25 00:36:16,604 - test_autobkp - INFO - Số lượng mẫu trong tập kiểm tra: 20
2025-04-25 00:36:16,604 - test_autobkp - ERROR - Thiếu cột mục tiêu chính HachToan trong tập huấn luyện
2025-04-25 00:36:16,604 - test_autobkp - ERROR - ✗ Kiểm tra chức năng tiền xử lý thất bại
2025-04-25 00:36:16,604 - test_autobkp - WARNING - Dừng các bài kiểm tra tiếp theo
2025-04-25 00:42:13,015 - config_manager - INFO - Đã tải cấu hình mặc định
2025-04-25 00:42:14,129 - test_autobkp - INFO - Đã khởi tạo AutoBKPTester với customer_id: test_customer
2025-04-25 00:42:14,129 - test_autobkp - INFO - Thư mục tạm: C:\Users\trant\AppData\Local\Temp\autobkp_test_tnedjzq6
2025-04-25 00:42:14,129 - test_autobkp - INFO - === BẮT ĐẦU CHẠY TẤT CẢ CÁC BÀI KIỂM TRA ===
2025-04-25 00:42:14,129 - test_autobkp - INFO - Bắt đầu kiểm tra cấu hình...
2025-04-25 00:42:14,129 - test_autobkp - INFO - Đã tải cấu hình mặc định thành công
2025-04-25 00:42:14,130 - test_autobkp - INFO - Đã tải cấu hình khách hàng test_customer thành công
2025-04-25 00:42:14,130 - test_autobkp - INFO - Kiểm tra cấu hình thành công
2025-04-25 00:42:14,130 - test_autobkp - INFO - ✓ Kiểm tra cấu hình thành công
2025-04-25 00:42:14,130 - test_autobkp - INFO - Bắt đầu tạo 100 dòng dữ liệu mẫu...
2025-04-25 00:42:14,132 - test_autobkp - INFO - Đã tạo dữ liệu mẫu và lưu vào: C:\Users\trant\AppData\Local\Temp\autobkp_test_tnedjzq6\test_customer_sample_data.csv
2025-04-25 00:42:14,132 - test_autobkp - INFO - ✓ Tạo dữ liệu mẫu thành công
2025-04-25 00:42:14,133 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng validate_data...
2025-04-25 00:42:14,133 - validate_data - INFO - Bắt đầu kiểm tra tính hợp lệ của dữ liệu từ file C:\Users\trant\AppData\Local\Temp\autobkp_test_tnedjzq6\test_customer_sample_data.csv
2025-04-25 00:42:14,159 - validate_data - INFO - Đã đọc file CSV với encoding utf-8
2025-04-25 00:42:14,163 - validate_data - INFO - Hoàn tất kiểm tra. Trạng thái: valid
2025-04-25 00:42:14,163 - validate_data - INFO - Tổng số cảnh báo: 0
2025-04-25 00:42:14,164 - test_autobkp - INFO - Kết quả validate: valid
2025-04-25 00:42:14,164 - test_autobkp - INFO - Đã lưu kết quả validate vào: C:\Users\trant\AppData\Local\Temp\autobkp_test_tnedjzq6\validate_result.json
2025-04-25 00:42:14,164 - test_autobkp - INFO - Kiểm tra chức năng validate_data thành công
2025-04-25 00:42:14,166 - test_autobkp - INFO - ✓ Kiểm tra chức năng validate_data thành công
2025-04-25 00:42:14,166 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng tiền xử lý dữ liệu...
2025-04-25 00:42:14,166 - preprocess - INFO - Bắt đầu tiền xử lý dữ liệu cho khách hàng test_customer
2025-04-25 00:42:14,166 - preprocess - INFO - Đọc dữ liệu từ: C:\Users\trant\AppData\Local\Temp\autobkp_test_tnedjzq6\test_customer_sample_data.csv
2025-04-25 00:42:14,168 - preprocess - INFO - Đọc thành công với encoding: utf-8
2025-04-25 00:42:14,168 - preprocess - INFO - Đã đọc 100 dòng dữ liệu từ C:\Users\trant\AppData\Local\Temp\autobkp_test_tnedjzq6\test_customer_sample_data.csv
2025-04-25 00:42:14,168 - preprocess - INFO - Tiền xử lý cột văn bản tiếng Việt: TenHangHoaDichVu
2025-04-25 00:42:14,169 - preprocess - INFO - Tiền xử lý cột ID: MSTNguoiBan
2025-04-25 00:42:14,170 - preprocess - INFO - Phân tích phân phối của biến mục tiêu: HachToan
2025-04-25 00:42:14,170 - preprocess - INFO - Số lượng lớp: 15
2025-04-25 00:42:14,171 - preprocess - INFO - Tỷ lệ mất cân bằng: 3.00
2025-04-25 00:42:14,171 - preprocess - INFO - Lớp hiếm nhất có 4 mẫu (4.00%)
2025-04-25 00:42:14,171 - preprocess - INFO - Lớp phổ biến nhất có 12 mẫu (12.00%)
2025-04-25 00:42:14,172 - preprocess - INFO - Phân tích phân phối của biến mục tiêu: MaHangHoa
2025-04-25 00:42:14,172 - preprocess - INFO - Số lượng lớp: 9
2025-04-25 00:42:14,172 - preprocess - INFO - Tỷ lệ mất cân bằng: 6.00
2025-04-25 00:42:14,172 - preprocess - INFO - Lớp hiếm nhất có 1 mẫu (3.03%)
2025-04-25 00:42:14,172 - preprocess - INFO - Lớp phổ biến nhất có 6 mẫu (18.18%)
2025-04-25 00:42:14,172 - preprocess - INFO - Phân chia dữ liệu với test_size=0.2
2025-04-25 00:42:14,173 - preprocess - INFO - Tập huấn luyện: 80 mẫu
2025-04-25 00:42:14,173 - preprocess - INFO - Tập kiểm tra: 20 mẫu
2025-04-25 00:42:14,177 - preprocess - INFO - Đã lưu tập huấn luyện: C:\Users\trant\AppData\Local\Temp\autobkp_test_tnedjzq6\test_customer_train_20250425_004214.csv
2025-04-25 00:42:14,178 - preprocess - INFO - Đã lưu tập kiểm tra: C:\Users\trant\AppData\Local\Temp\autobkp_test_tnedjzq6\test_customer_test_20250425_004214.csv
2025-04-25 00:42:14,178 - app.config.utils - INFO - Đã lưu metadata tại: C:\Users\trant\AppData\Local\Temp\autobkp_test_tnedjzq6\test_customer_metadata_20250425_004214.json
2025-04-25 00:42:14,179 - preprocess - INFO - Đã lưu metadata: C:\Users\trant\AppData\Local\Temp\autobkp_test_tnedjzq6\test_customer_metadata_20250425_004214.json
2025-04-25 00:42:14,179 - test_autobkp - INFO - Đã tiền xử lý dữ liệu thành công
2025-04-25 00:42:14,179 - test_autobkp - INFO - - Tập huấn luyện: C:\Users\trant\AppData\Local\Temp\autobkp_test_tnedjzq6\test_customer_train_20250425_004214.csv
2025-04-25 00:42:14,179 - test_autobkp - INFO - - Tập kiểm tra: C:\Users\trant\AppData\Local\Temp\autobkp_test_tnedjzq6\test_customer_test_20250425_004214.csv
2025-04-25 00:42:14,228 - test_autobkp - INFO - Số lượng mẫu trong tập huấn luyện: 80
2025-04-25 00:42:14,228 - test_autobkp - INFO - Số lượng mẫu trong tập kiểm tra: 20
2025-04-25 00:42:14,228 - test_autobkp - INFO - Kiểm tra chức năng tiền xử lý dữ liệu thành công
2025-04-25 00:42:14,229 - test_autobkp - INFO - ✓ Kiểm tra chức năng tiền xử lý thành công
2025-04-25 00:42:14,229 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng huấn luyện mô hình...
2025-04-25 00:42:14,229 - train - INFO - Bắt đầu huấn luyện mô hình cho khách hàng test_customer
2025-04-25 00:42:14,230 - train - INFO - Đã đọc 80 dòng dữ liệu huấn luyện từ C:\Users\trant\AppData\Local\Temp\autobkp_test_tnedjzq6\test_customer_train_20250425_004214.csv
2025-04-25 00:42:14,231 - train - INFO - Đã đọc 20 dòng dữ liệu kiểm tra từ C:\Users\trant\AppData\Local\Temp\autobkp_test_tnedjzq6\test_customer_test_20250425_004214.csv
2025-04-25 00:42:14,232 - train - ERROR - Lỗi khi huấn luyện mô hình: 'ModelTrainer' object has no attribute 'train_hachtoan_model'
Traceback (most recent call last):
  File "D:\Python\AutoBKP_V2\app\scripts\train.py", line 1641, in train_customer_model
    trainer.train_hachtoan_model(train_df)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ModelTrainer' object has no attribute 'train_hachtoan_model'. Did you mean: 'hachtoan_model'?
2025-04-25 00:42:14,234 - test_autobkp - ERROR - Lỗi khi huấn luyện mô hình: 'ModelTrainer' object has no attribute 'train_hachtoan_model'
2025-04-25 00:42:14,234 - test_autobkp - ERROR - ✗ Kiểm tra chức năng huấn luyện thất bại
2025-04-25 00:42:14,234 - test_autobkp - WARNING - Dừng các bài kiểm tra tiếp theo
2025-04-25 00:49:36,177 - config_manager - INFO - Đã tải cấu hình mặc định
2025-04-25 00:49:37,277 - test_autobkp - INFO - Đã khởi tạo AutoBKPTester với customer_id: test_customer
2025-04-25 00:49:37,279 - test_autobkp - INFO - Thư mục tạm: C:\Users\trant\AppData\Local\Temp\autobkp_test_nk3c9gej
2025-04-25 00:49:37,279 - test_autobkp - INFO - === BẮT ĐẦU CHẠY TẤT CẢ CÁC BÀI KIỂM TRA ===
2025-04-25 00:49:37,279 - test_autobkp - INFO - Bắt đầu kiểm tra cấu hình...
2025-04-25 00:49:37,279 - test_autobkp - INFO - Đã tải cấu hình mặc định thành công
2025-04-25 00:49:37,279 - test_autobkp - INFO - Đã tải cấu hình khách hàng test_customer thành công
2025-04-25 00:49:37,279 - test_autobkp - INFO - Kiểm tra cấu hình thành công
2025-04-25 00:49:37,279 - test_autobkp - INFO - ✓ Kiểm tra cấu hình thành công
2025-04-25 00:49:37,279 - test_autobkp - INFO - Bắt đầu tạo 100 dòng dữ liệu mẫu...
2025-04-25 00:49:37,282 - test_autobkp - INFO - Đã tạo dữ liệu mẫu và lưu vào: C:\Users\trant\AppData\Local\Temp\autobkp_test_nk3c9gej\test_customer_sample_data.csv
2025-04-25 00:49:37,282 - test_autobkp - INFO - ✓ Tạo dữ liệu mẫu thành công
2025-04-25 00:49:37,282 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng validate_data...
2025-04-25 00:49:37,282 - validate_data - INFO - Bắt đầu kiểm tra tính hợp lệ của dữ liệu từ file C:\Users\trant\AppData\Local\Temp\autobkp_test_nk3c9gej\test_customer_sample_data.csv
2025-04-25 00:49:37,312 - validate_data - INFO - Đã đọc file CSV với encoding utf-8
2025-04-25 00:49:37,316 - validate_data - INFO - Hoàn tất kiểm tra. Trạng thái: valid
2025-04-25 00:49:37,316 - validate_data - INFO - Tổng số cảnh báo: 0
2025-04-25 00:49:37,317 - test_autobkp - INFO - Kết quả validate: valid
2025-04-25 00:49:37,318 - test_autobkp - INFO - Đã lưu kết quả validate vào: C:\Users\trant\AppData\Local\Temp\autobkp_test_nk3c9gej\validate_result.json
2025-04-25 00:49:37,318 - test_autobkp - INFO - Kiểm tra chức năng validate_data thành công
2025-04-25 00:49:37,319 - test_autobkp - INFO - ✓ Kiểm tra chức năng validate_data thành công
2025-04-25 00:49:37,319 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng tiền xử lý dữ liệu...
2025-04-25 00:49:37,319 - preprocess - INFO - Bắt đầu tiền xử lý dữ liệu cho khách hàng test_customer
2025-04-25 00:49:37,320 - preprocess - INFO - Đọc dữ liệu từ: C:\Users\trant\AppData\Local\Temp\autobkp_test_nk3c9gej\test_customer_sample_data.csv
2025-04-25 00:49:37,321 - preprocess - INFO - Đọc thành công với encoding: utf-8
2025-04-25 00:49:37,322 - preprocess - INFO - Đã đọc 100 dòng dữ liệu từ C:\Users\trant\AppData\Local\Temp\autobkp_test_nk3c9gej\test_customer_sample_data.csv
2025-04-25 00:49:37,322 - preprocess - INFO - Tiền xử lý cột văn bản tiếng Việt: TenHangHoaDichVu
2025-04-25 00:49:37,324 - preprocess - INFO - Tiền xử lý cột ID: MSTNguoiBan
2025-04-25 00:49:37,324 - preprocess - INFO - Phân tích phân phối của biến mục tiêu: HachToan
2025-04-25 00:49:37,324 - preprocess - INFO - Số lượng lớp: 15
2025-04-25 00:49:37,326 - preprocess - INFO - Tỷ lệ mất cân bằng: 5.00
2025-04-25 00:49:37,326 - preprocess - INFO - Lớp hiếm nhất có 3 mẫu (3.00%)
2025-04-25 00:49:37,326 - preprocess - INFO - Lớp phổ biến nhất có 15 mẫu (15.00%)
2025-04-25 00:49:37,327 - preprocess - INFO - Phân tích phân phối của biến mục tiêu: MaHangHoa
2025-04-25 00:49:37,327 - preprocess - INFO - Số lượng lớp: 9
2025-04-25 00:49:37,328 - preprocess - INFO - Tỷ lệ mất cân bằng: 8.00
2025-04-25 00:49:37,328 - preprocess - INFO - Lớp hiếm nhất có 1 mẫu (3.03%)
2025-04-25 00:49:37,328 - preprocess - INFO - Lớp phổ biến nhất có 8 mẫu (24.24%)
2025-04-25 00:49:37,328 - preprocess - INFO - Phân chia dữ liệu với test_size=0.2
2025-04-25 00:49:37,329 - preprocess - INFO - Tập huấn luyện: 80 mẫu
2025-04-25 00:49:37,329 - preprocess - INFO - Tập kiểm tra: 20 mẫu
2025-04-25 00:49:37,340 - preprocess - INFO - Đã lưu tập huấn luyện: C:\Users\trant\AppData\Local\Temp\autobkp_test_nk3c9gej\test_customer_train_20250425_004937.csv
2025-04-25 00:49:37,340 - preprocess - INFO - Đã lưu tập kiểm tra: C:\Users\trant\AppData\Local\Temp\autobkp_test_nk3c9gej\test_customer_test_20250425_004937.csv
2025-04-25 00:49:37,341 - app.config.utils - INFO - Đã lưu metadata tại: C:\Users\trant\AppData\Local\Temp\autobkp_test_nk3c9gej\test_customer_metadata_20250425_004937.json
2025-04-25 00:49:37,341 - preprocess - INFO - Đã lưu metadata: C:\Users\trant\AppData\Local\Temp\autobkp_test_nk3c9gej\test_customer_metadata_20250425_004937.json
2025-04-25 00:49:37,341 - test_autobkp - INFO - Đã tiền xử lý dữ liệu thành công
2025-04-25 00:49:37,342 - test_autobkp - INFO - - Tập huấn luyện: C:\Users\trant\AppData\Local\Temp\autobkp_test_nk3c9gej\test_customer_train_20250425_004937.csv
2025-04-25 00:49:37,342 - test_autobkp - INFO - - Tập kiểm tra: C:\Users\trant\AppData\Local\Temp\autobkp_test_nk3c9gej\test_customer_test_20250425_004937.csv
2025-04-25 00:49:37,398 - test_autobkp - INFO - Số lượng mẫu trong tập huấn luyện: 80
2025-04-25 00:49:37,398 - test_autobkp - INFO - Số lượng mẫu trong tập kiểm tra: 20
2025-04-25 00:49:37,399 - test_autobkp - INFO - Kiểm tra chức năng tiền xử lý dữ liệu thành công
2025-04-25 00:49:37,399 - test_autobkp - INFO - ✓ Kiểm tra chức năng tiền xử lý thành công
2025-04-25 00:49:37,399 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng huấn luyện mô hình...
2025-04-25 00:49:37,400 - train - INFO - Bắt đầu huấn luyện mô hình cho khách hàng test_customer
2025-04-25 00:49:37,401 - train - INFO - Đã đọc 80 dòng dữ liệu huấn luyện từ C:\Users\trant\AppData\Local\Temp\autobkp_test_nk3c9gej\test_customer_train_20250425_004937.csv
2025-04-25 00:49:37,401 - train - INFO - Đã đọc 20 dòng dữ liệu kiểm tra từ C:\Users\trant\AppData\Local\Temp\autobkp_test_nk3c9gej\test_customer_test_20250425_004937.csv
2025-04-25 00:49:37,404 - train - INFO - Bắt đầu huấn luyện mô hình HachToan cho khách hàng test_customer
2025-04-25 00:49:37,404 - train - INFO - Tiền xử lý dữ liệu...
2025-04-25 00:49:37,405 - train - INFO - Tạo feature extractor...
2025-04-25 00:49:37,405 - app.utils.feature_extraction - WARNING - Không tìm thấy thư viện xử lý tiếng Việt (underthesea, pyvi). Chức năng xử lý tiếng Việt sẽ bị hạn chế.
2025-04-25 00:49:37,406 - train - INFO - Trích xuất đặc trưng...
2025-04-25 00:49:37,406 - train - ERROR - Lỗi khi huấn luyện mô hình: OneHotEncoder.__init__() got an unexpected keyword argument 'sparse'
Traceback (most recent call last):
  File "D:\Python\AutoBKP_V2\app\scripts\train.py", line 1641, in train_customer_model
    trainer.train_hachtoan_model(train_df)
  File "D:\Python\AutoBKP_V2\app\scripts\train.py", line 442, in train_hachtoan_model
    X_transformed = self.feature_extractor.fit_transform(X)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\app\utils\feature_extraction.py", line 222, in fit_transform
    return self.fit(df, y).transform(df)
           ^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\app\utils\feature_extraction.py", line 174, in fit
    encoder = OneHotEncoder(handle_unknown='ignore', sparse=False)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: OneHotEncoder.__init__() got an unexpected keyword argument 'sparse'
2025-04-25 00:49:37,408 - test_autobkp - ERROR - Lỗi khi huấn luyện mô hình: OneHotEncoder.__init__() got an unexpected keyword argument 'sparse'
2025-04-25 00:49:37,408 - test_autobkp - ERROR - ✗ Kiểm tra chức năng huấn luyện thất bại
2025-04-25 00:49:37,408 - test_autobkp - WARNING - Dừng các bài kiểm tra tiếp theo
2025-04-26 00:18:51,230 - config_manager - INFO - Đã tải cấu hình mặc định
2025-04-26 00:18:58,800 - test_autobkp - INFO - Đã khởi tạo AutoBKPTester với customer_id: test_customer
2025-04-26 00:18:58,802 - test_autobkp - INFO - Thư mục tạm: C:\Users\trant\AppData\Local\Temp\autobkp_test_aanq4pys
2025-04-26 00:18:58,802 - test_autobkp - INFO - === BẮT ĐẦU CHẠY TẤT CẢ CÁC BÀI KIỂM TRA ===
2025-04-26 00:18:58,803 - test_autobkp - INFO - Bắt đầu kiểm tra cấu hình...
2025-04-26 00:18:58,803 - test_autobkp - INFO - Đã tải cấu hình mặc định thành công
2025-04-26 00:18:58,811 - test_autobkp - INFO - Đã tải cấu hình khách hàng test_customer thành công
2025-04-26 00:18:58,811 - test_autobkp - INFO - Kiểm tra cấu hình thành công
2025-04-26 00:18:58,811 - test_autobkp - INFO - ✓ Kiểm tra cấu hình thành công
2025-04-26 00:18:58,811 - test_autobkp - INFO - Bắt đầu tạo 100 dòng dữ liệu mẫu...
2025-04-26 00:18:58,814 - test_autobkp - INFO - Đã tạo dữ liệu mẫu và lưu vào: C:\Users\trant\AppData\Local\Temp\autobkp_test_aanq4pys\test_customer_sample_data.csv
2025-04-26 00:18:58,815 - test_autobkp - INFO - ✓ Tạo dữ liệu mẫu thành công
2025-04-26 00:18:58,815 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng validate_data...
2025-04-26 00:18:58,815 - validate_data - INFO - Bắt đầu kiểm tra tính hợp lệ của dữ liệu từ file C:\Users\trant\AppData\Local\Temp\autobkp_test_aanq4pys\test_customer_sample_data.csv
2025-04-26 00:18:58,843 - validate_data - INFO - Đã đọc file CSV với encoding utf-8
2025-04-26 00:18:58,848 - validate_data - INFO - Hoàn tất kiểm tra. Trạng thái: warnings
2025-04-26 00:18:58,849 - validate_data - INFO - Tổng số cảnh báo: 1
2025-04-26 00:18:58,849 - test_autobkp - INFO - Kết quả validate: warnings
2025-04-26 00:18:58,850 - test_autobkp - INFO - Đã lưu kết quả validate vào: C:\Users\trant\AppData\Local\Temp\autobkp_test_aanq4pys\validate_result.json
2025-04-26 00:18:58,850 - test_autobkp - WARNING - Tìm thấy 1 cảnh báo trong dữ liệu
2025-04-26 00:18:58,851 - test_autobkp - WARNING - - Class imbalance detected in primary target (severity: medium)
2025-04-26 00:18:58,851 - test_autobkp - INFO - Kiểm tra chức năng validate_data thành công
2025-04-26 00:18:58,851 - test_autobkp - INFO - ✓ Kiểm tra chức năng validate_data thành công
2025-04-26 00:18:58,851 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng tiền xử lý dữ liệu...
2025-04-26 00:18:58,851 - preprocess - INFO - Bắt đầu tiền xử lý dữ liệu cho khách hàng test_customer
2025-04-26 00:18:58,853 - preprocess - INFO - Đọc dữ liệu từ: C:\Users\trant\AppData\Local\Temp\autobkp_test_aanq4pys\test_customer_sample_data.csv
2025-04-26 00:18:58,854 - preprocess - INFO - Đọc thành công với encoding: utf-8
2025-04-26 00:18:58,855 - preprocess - INFO - Đã đọc 100 dòng dữ liệu từ C:\Users\trant\AppData\Local\Temp\autobkp_test_aanq4pys\test_customer_sample_data.csv
2025-04-26 00:18:58,856 - preprocess - INFO - Tiền xử lý cột văn bản tiếng Việt: TenHangHoaDichVu
2025-04-26 00:18:58,857 - preprocess - INFO - Tiền xử lý cột ID: MSTNguoiBan
2025-04-26 00:18:58,858 - preprocess - INFO - Phân tích phân phối của biến mục tiêu: HachToan
2025-04-26 00:18:58,858 - preprocess - INFO - Số lượng lớp: 15
2025-04-26 00:18:58,859 - preprocess - INFO - Tỷ lệ mất cân bằng: 12.00
2025-04-26 00:18:58,859 - preprocess - INFO - Lớp hiếm nhất có 1 mẫu (1.00%)
2025-04-26 00:18:58,859 - preprocess - INFO - Lớp phổ biến nhất có 12 mẫu (12.00%)
2025-04-26 00:18:58,860 - preprocess - INFO - Phân tích phân phối của biến mục tiêu: MaHangHoa
2025-04-26 00:18:58,860 - preprocess - INFO - Số lượng lớp: 10
2025-04-26 00:18:58,861 - preprocess - INFO - Tỷ lệ mất cân bằng: 5.00
2025-04-26 00:18:58,861 - preprocess - INFO - Lớp hiếm nhất có 1 mẫu (2.86%)
2025-04-26 00:18:58,861 - preprocess - INFO - Lớp phổ biến nhất có 5 mẫu (14.29%)
2025-04-26 00:18:58,861 - preprocess - INFO - Phân chia dữ liệu với test_size=0.2
2025-04-26 00:18:58,861 - preprocess - INFO - Tập huấn luyện: 80 mẫu
2025-04-26 00:18:58,861 - preprocess - INFO - Tập kiểm tra: 20 mẫu
2025-04-26 00:18:58,866 - preprocess - INFO - Đã lưu tập huấn luyện: C:\Users\trant\AppData\Local\Temp\autobkp_test_aanq4pys\test_customer_train_20250426_001858.csv
2025-04-26 00:18:58,866 - preprocess - INFO - Đã lưu tập kiểm tra: C:\Users\trant\AppData\Local\Temp\autobkp_test_aanq4pys\test_customer_test_20250426_001858.csv
2025-04-26 00:18:58,867 - app.config.utils - INFO - Đã lưu metadata tại: C:\Users\trant\AppData\Local\Temp\autobkp_test_aanq4pys\test_customer_metadata_20250426_001858.json
2025-04-26 00:18:58,867 - preprocess - INFO - Đã lưu metadata: C:\Users\trant\AppData\Local\Temp\autobkp_test_aanq4pys\test_customer_metadata_20250426_001858.json
2025-04-26 00:18:58,867 - test_autobkp - INFO - Đã tiền xử lý dữ liệu thành công
2025-04-26 00:18:58,867 - test_autobkp - INFO - - Tập huấn luyện: C:\Users\trant\AppData\Local\Temp\autobkp_test_aanq4pys\test_customer_train_20250426_001858.csv
2025-04-26 00:18:58,867 - test_autobkp - INFO - - Tập kiểm tra: C:\Users\trant\AppData\Local\Temp\autobkp_test_aanq4pys\test_customer_test_20250426_001858.csv
2025-04-26 00:18:58,916 - test_autobkp - INFO - Số lượng mẫu trong tập huấn luyện: 80
2025-04-26 00:18:58,917 - test_autobkp - INFO - Số lượng mẫu trong tập kiểm tra: 20
2025-04-26 00:18:58,917 - test_autobkp - INFO - Kiểm tra chức năng tiền xử lý dữ liệu thành công
2025-04-26 00:18:58,918 - test_autobkp - INFO - ✓ Kiểm tra chức năng tiền xử lý thành công
2025-04-26 00:18:58,918 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng huấn luyện mô hình...
2025-04-26 00:18:58,918 - train - INFO - Bắt đầu huấn luyện mô hình cho khách hàng test_customer
2025-04-26 00:18:58,919 - train - INFO - Đã đọc 80 dòng dữ liệu huấn luyện từ C:\Users\trant\AppData\Local\Temp\autobkp_test_aanq4pys\test_customer_train_20250426_001858.csv
2025-04-26 00:18:58,921 - train - INFO - Đã đọc 20 dòng dữ liệu kiểm tra từ C:\Users\trant\AppData\Local\Temp\autobkp_test_aanq4pys\test_customer_test_20250426_001858.csv
2025-04-26 00:18:58,922 - train - INFO - Bắt đầu huấn luyện mô hình HachToan cho khách hàng test_customer
2025-04-26 00:18:58,922 - train - INFO - Tiền xử lý dữ liệu...
2025-04-26 00:18:58,924 - train - INFO - Tạo feature extractor...
2025-04-26 00:18:58,924 - app.utils.feature_extraction - WARNING - Không tìm thấy thư viện xử lý tiếng Việt (underthesea, pyvi). Chức năng xử lý tiếng Việt sẽ bị hạn chế.
2025-04-26 00:18:58,925 - train - INFO - Trích xuất đặc trưng...
2025-04-26 00:18:58,925 - train - ERROR - Lỗi khi huấn luyện mô hình: OneHotEncoder.__init__() got an unexpected keyword argument 'sparse'
Traceback (most recent call last):
  File "D:\Python\AutoBKP_V2\app\scripts\train.py", line 1641, in train_customer_model
    trainer.train_hachtoan_model(train_df)
  File "D:\Python\AutoBKP_V2\app\scripts\train.py", line 442, in train_hachtoan_model
    X_transformed = self.feature_extractor.fit_transform(X)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\app\utils\feature_extraction.py", line 222, in fit_transform
    return self.fit(df, y).transform(df)
           ^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\app\utils\feature_extraction.py", line 174, in fit
    encoder = OneHotEncoder(handle_unknown='ignore', sparse=False)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: OneHotEncoder.__init__() got an unexpected keyword argument 'sparse'
2025-04-26 00:18:58,970 - test_autobkp - ERROR - Lỗi khi huấn luyện mô hình: OneHotEncoder.__init__() got an unexpected keyword argument 'sparse'
2025-04-26 00:18:58,971 - test_autobkp - ERROR - ✗ Kiểm tra chức năng huấn luyện thất bại
2025-04-26 00:18:58,971 - test_autobkp - WARNING - Dừng các bài kiểm tra tiếp theo
2025-04-26 00:26:55,785 - config_manager - INFO - Đã tải cấu hình mặc định
2025-04-26 00:26:56,858 - test_autobkp - INFO - Đã khởi tạo AutoBKPTester với customer_id: test_customer
2025-04-26 00:26:56,859 - test_autobkp - INFO - Thư mục tạm: C:\Users\trant\AppData\Local\Temp\autobkp_test_jq2yynrr
2025-04-26 00:26:56,859 - test_autobkp - INFO - === BẮT ĐẦU CHẠY TẤT CẢ CÁC BÀI KIỂM TRA ===
2025-04-26 00:26:56,859 - test_autobkp - INFO - Bắt đầu kiểm tra cấu hình...
2025-04-26 00:26:56,859 - test_autobkp - INFO - Đã tải cấu hình mặc định thành công
2025-04-26 00:26:56,859 - test_autobkp - INFO - Đã tải cấu hình khách hàng test_customer thành công
2025-04-26 00:26:56,859 - test_autobkp - INFO - Kiểm tra cấu hình thành công
2025-04-26 00:26:56,859 - test_autobkp - INFO - ✓ Kiểm tra cấu hình thành công
2025-04-26 00:26:56,860 - test_autobkp - INFO - Bắt đầu tạo 100 dòng dữ liệu mẫu...
2025-04-26 00:26:56,861 - test_autobkp - INFO - Đã tạo dữ liệu mẫu và lưu vào: C:\Users\trant\AppData\Local\Temp\autobkp_test_jq2yynrr\test_customer_sample_data.csv
2025-04-26 00:26:56,861 - test_autobkp - INFO - ✓ Tạo dữ liệu mẫu thành công
2025-04-26 00:26:56,861 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng validate_data...
2025-04-26 00:26:56,861 - validate_data - INFO - Bắt đầu kiểm tra tính hợp lệ của dữ liệu từ file C:\Users\trant\AppData\Local\Temp\autobkp_test_jq2yynrr\test_customer_sample_data.csv
2025-04-26 00:26:56,894 - validate_data - INFO - Đã đọc file CSV với encoding utf-8
2025-04-26 00:26:56,898 - validate_data - INFO - Hoàn tất kiểm tra. Trạng thái: valid
2025-04-26 00:26:56,899 - validate_data - INFO - Tổng số cảnh báo: 0
2025-04-26 00:26:56,899 - test_autobkp - INFO - Kết quả validate: valid
2025-04-26 00:26:56,900 - test_autobkp - INFO - Đã lưu kết quả validate vào: C:\Users\trant\AppData\Local\Temp\autobkp_test_jq2yynrr\validate_result.json
2025-04-26 00:26:56,900 - test_autobkp - INFO - Kiểm tra chức năng validate_data thành công
2025-04-26 00:26:56,900 - test_autobkp - INFO - ✓ Kiểm tra chức năng validate_data thành công
2025-04-26 00:26:56,900 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng tiền xử lý dữ liệu...
2025-04-26 00:26:56,900 - preprocess - INFO - Bắt đầu tiền xử lý dữ liệu cho khách hàng test_customer
2025-04-26 00:26:56,902 - preprocess - INFO - Đọc dữ liệu từ: C:\Users\trant\AppData\Local\Temp\autobkp_test_jq2yynrr\test_customer_sample_data.csv
2025-04-26 00:26:56,903 - preprocess - INFO - Đọc thành công với encoding: utf-8
2025-04-26 00:26:56,903 - preprocess - INFO - Đã đọc 100 dòng dữ liệu từ C:\Users\trant\AppData\Local\Temp\autobkp_test_jq2yynrr\test_customer_sample_data.csv
2025-04-26 00:26:56,904 - preprocess - INFO - Tiền xử lý cột văn bản tiếng Việt: TenHangHoaDichVu
2025-04-26 00:26:56,906 - preprocess - INFO - Tiền xử lý cột ID: MSTNguoiBan
2025-04-26 00:26:56,906 - preprocess - INFO - Phân tích phân phối của biến mục tiêu: HachToan
2025-04-26 00:26:56,907 - preprocess - INFO - Số lượng lớp: 15
2025-04-26 00:26:56,907 - preprocess - INFO - Tỷ lệ mất cân bằng: 3.67
2025-04-26 00:26:56,907 - preprocess - INFO - Lớp hiếm nhất có 3 mẫu (3.00%)
2025-04-26 00:26:56,907 - preprocess - INFO - Lớp phổ biến nhất có 11 mẫu (11.00%)
2025-04-26 00:26:56,908 - preprocess - INFO - Phân tích phân phối của biến mục tiêu: MaHangHoa
2025-04-26 00:26:56,908 - preprocess - INFO - Số lượng lớp: 9
2025-04-26 00:26:56,909 - preprocess - INFO - Tỷ lệ mất cân bằng: 4.00
2025-04-26 00:26:56,909 - preprocess - INFO - Lớp hiếm nhất có 1 mẫu (4.17%)
2025-04-26 00:26:56,909 - preprocess - INFO - Lớp phổ biến nhất có 4 mẫu (16.67%)
2025-04-26 00:26:56,909 - preprocess - INFO - Phân chia dữ liệu với test_size=0.2
2025-04-26 00:26:56,910 - preprocess - INFO - Tập huấn luyện: 80 mẫu
2025-04-26 00:26:56,911 - preprocess - INFO - Tập kiểm tra: 20 mẫu
2025-04-26 00:26:56,920 - preprocess - INFO - Đã lưu tập huấn luyện: C:\Users\trant\AppData\Local\Temp\autobkp_test_jq2yynrr\test_customer_train_20250426_002656.csv
2025-04-26 00:26:56,920 - preprocess - INFO - Đã lưu tập kiểm tra: C:\Users\trant\AppData\Local\Temp\autobkp_test_jq2yynrr\test_customer_test_20250426_002656.csv
2025-04-26 00:26:56,922 - app.config.utils - INFO - Đã lưu metadata tại: C:\Users\trant\AppData\Local\Temp\autobkp_test_jq2yynrr\test_customer_metadata_20250426_002656.json
2025-04-26 00:26:56,922 - preprocess - INFO - Đã lưu metadata: C:\Users\trant\AppData\Local\Temp\autobkp_test_jq2yynrr\test_customer_metadata_20250426_002656.json
2025-04-26 00:26:56,922 - test_autobkp - INFO - Đã tiền xử lý dữ liệu thành công
2025-04-26 00:26:56,923 - test_autobkp - INFO - - Tập huấn luyện: C:\Users\trant\AppData\Local\Temp\autobkp_test_jq2yynrr\test_customer_train_20250426_002656.csv
2025-04-26 00:26:56,923 - test_autobkp - INFO - - Tập kiểm tra: C:\Users\trant\AppData\Local\Temp\autobkp_test_jq2yynrr\test_customer_test_20250426_002656.csv
2025-04-26 00:26:56,969 - test_autobkp - INFO - Số lượng mẫu trong tập huấn luyện: 80
2025-04-26 00:26:56,969 - test_autobkp - INFO - Số lượng mẫu trong tập kiểm tra: 20
2025-04-26 00:26:56,969 - test_autobkp - INFO - Kiểm tra chức năng tiền xử lý dữ liệu thành công
2025-04-26 00:26:56,970 - test_autobkp - INFO - ✓ Kiểm tra chức năng tiền xử lý thành công
2025-04-26 00:26:56,970 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng huấn luyện mô hình...
2025-04-26 00:26:56,970 - train - INFO - Bắt đầu huấn luyện mô hình cho khách hàng test_customer
2025-04-26 00:26:56,971 - train - INFO - Đã đọc 80 dòng dữ liệu huấn luyện từ C:\Users\trant\AppData\Local\Temp\autobkp_test_jq2yynrr\test_customer_train_20250426_002656.csv
2025-04-26 00:26:56,973 - train - INFO - Đã đọc 20 dòng dữ liệu kiểm tra từ C:\Users\trant\AppData\Local\Temp\autobkp_test_jq2yynrr\test_customer_test_20250426_002656.csv
2025-04-26 00:26:56,974 - train - INFO - Bắt đầu huấn luyện mô hình HachToan cho khách hàng test_customer
2025-04-26 00:26:56,974 - train - INFO - Tiền xử lý dữ liệu...
2025-04-26 00:26:56,976 - train - INFO - Tạo feature extractor...
2025-04-26 00:26:56,977 - app.utils.feature_extraction - WARNING - Không tìm thấy thư viện xử lý tiếng Việt (underthesea, pyvi). Chức năng xử lý tiếng Việt sẽ bị hạn chế.
2025-04-26 00:26:56,977 - train - INFO - Trích xuất đặc trưng...
2025-04-26 00:26:56,988 - train - ERROR - Lỗi khi huấn luyện mô hình: Estimator preprocess does not provide get_feature_names_out. Did you mean to call pipeline[:-1].get_feature_names_out()?
Traceback (most recent call last):
  File "D:\Python\AutoBKP_V2\app\scripts\train.py", line 1641, in train_customer_model
    trainer.train_hachtoan_model(train_df)
  File "D:\Python\AutoBKP_V2\app\scripts\train.py", line 442, in train_hachtoan_model
    X_transformed = self.feature_extractor.fit_transform(X)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\app\utils\feature_extraction.py", line 222, in fit_transform
    return self.fit(df, y).transform(df)
           ^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\app\utils\feature_extraction.py", line 192, in fit
    self.feature_names = self._get_feature_names()
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\app\utils\feature_extraction.py", line 275, in _get_feature_names
    col_names = [f"{column}_{feat}" for feat in transformer.get_feature_names_out()]
                                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\sklearn\pipeline.py", line 1276, in get_feature_names_out
    raise AttributeError(
AttributeError: Estimator preprocess does not provide get_feature_names_out. Did you mean to call pipeline[:-1].get_feature_names_out()?
2025-04-26 00:26:57,003 - test_autobkp - ERROR - Lỗi khi huấn luyện mô hình: Estimator preprocess does not provide get_feature_names_out. Did you mean to call pipeline[:-1].get_feature_names_out()?
2025-04-26 00:26:57,003 - test_autobkp - ERROR - ✗ Kiểm tra chức năng huấn luyện thất bại
2025-04-26 00:26:57,004 - test_autobkp - WARNING - Dừng các bài kiểm tra tiếp theo
2025-04-26 00:38:38,990 - config_manager - INFO - Đã tải cấu hình mặc định
2025-04-26 00:38:40,123 - test_autobkp - INFO - Đã khởi tạo AutoBKPTester với customer_id: test_customer
2025-04-26 00:38:40,124 - test_autobkp - INFO - Thư mục tạm: C:\Users\trant\AppData\Local\Temp\autobkp_test_6n0w5bih
2025-04-26 00:38:40,124 - test_autobkp - INFO - === BẮT ĐẦU CHẠY TẤT CẢ CÁC BÀI KIỂM TRA ===
2025-04-26 00:38:40,124 - test_autobkp - INFO - Bắt đầu kiểm tra cấu hình...
2025-04-26 00:38:40,124 - test_autobkp - INFO - Đã tải cấu hình mặc định thành công
2025-04-26 00:38:40,131 - test_autobkp - INFO - Đã tải cấu hình khách hàng test_customer thành công
2025-04-26 00:38:40,131 - test_autobkp - INFO - Kiểm tra cấu hình thành công
2025-04-26 00:38:40,132 - test_autobkp - INFO - ✓ Kiểm tra cấu hình thành công
2025-04-26 00:38:40,132 - test_autobkp - INFO - Bắt đầu tạo 100 dòng dữ liệu mẫu...
2025-04-26 00:38:40,135 - test_autobkp - INFO - Đã tạo dữ liệu mẫu và lưu vào: C:\Users\trant\AppData\Local\Temp\autobkp_test_6n0w5bih\test_customer_sample_data.csv
2025-04-26 00:38:40,135 - test_autobkp - INFO - ✓ Tạo dữ liệu mẫu thành công
2025-04-26 00:38:40,135 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng validate_data...
2025-04-26 00:38:40,135 - validate_data - INFO - Bắt đầu kiểm tra tính hợp lệ của dữ liệu từ file C:\Users\trant\AppData\Local\Temp\autobkp_test_6n0w5bih\test_customer_sample_data.csv
2025-04-26 00:38:40,160 - validate_data - INFO - Đã đọc file CSV với encoding utf-8
2025-04-26 00:38:40,164 - validate_data - INFO - Hoàn tất kiểm tra. Trạng thái: valid
2025-04-26 00:38:40,164 - validate_data - INFO - Tổng số cảnh báo: 0
2025-04-26 00:38:40,164 - test_autobkp - INFO - Kết quả validate: valid
2025-04-26 00:38:40,166 - test_autobkp - INFO - Đã lưu kết quả validate vào: C:\Users\trant\AppData\Local\Temp\autobkp_test_6n0w5bih\validate_result.json
2025-04-26 00:38:40,166 - test_autobkp - INFO - Kiểm tra chức năng validate_data thành công
2025-04-26 00:38:40,166 - test_autobkp - INFO - ✓ Kiểm tra chức năng validate_data thành công
2025-04-26 00:38:40,166 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng tiền xử lý dữ liệu...
2025-04-26 00:38:40,167 - preprocess - INFO - Bắt đầu tiền xử lý dữ liệu cho khách hàng test_customer
2025-04-26 00:38:40,167 - preprocess - INFO - Đọc dữ liệu từ: C:\Users\trant\AppData\Local\Temp\autobkp_test_6n0w5bih\test_customer_sample_data.csv
2025-04-26 00:38:40,169 - preprocess - INFO - Đọc thành công với encoding: utf-8
2025-04-26 00:38:40,170 - preprocess - INFO - Đã đọc 100 dòng dữ liệu từ C:\Users\trant\AppData\Local\Temp\autobkp_test_6n0w5bih\test_customer_sample_data.csv
2025-04-26 00:38:40,170 - preprocess - INFO - Tiền xử lý cột văn bản tiếng Việt: TenHangHoaDichVu
2025-04-26 00:38:40,172 - preprocess - INFO - Tiền xử lý cột ID: MSTNguoiBan
2025-04-26 00:38:40,172 - preprocess - INFO - Phân tích phân phối của biến mục tiêu: HachToan
2025-04-26 00:38:40,173 - preprocess - INFO - Số lượng lớp: 15
2025-04-26 00:38:40,173 - preprocess - INFO - Tỷ lệ mất cân bằng: 3.67
2025-04-26 00:38:40,174 - preprocess - INFO - Lớp hiếm nhất có 3 mẫu (3.00%)
2025-04-26 00:38:40,174 - preprocess - INFO - Lớp phổ biến nhất có 11 mẫu (11.00%)
2025-04-26 00:38:40,174 - preprocess - INFO - Phân tích phân phối của biến mục tiêu: MaHangHoa
2025-04-26 00:38:40,175 - preprocess - INFO - Số lượng lớp: 10
2025-04-26 00:38:40,175 - preprocess - INFO - Tỷ lệ mất cân bằng: 6.00
2025-04-26 00:38:40,175 - preprocess - INFO - Lớp hiếm nhất có 1 mẫu (3.12%)
2025-04-26 00:38:40,175 - preprocess - INFO - Lớp phổ biến nhất có 6 mẫu (18.75%)
2025-04-26 00:38:40,176 - preprocess - INFO - Phân chia dữ liệu với test_size=0.2
2025-04-26 00:38:40,176 - preprocess - INFO - Tập huấn luyện: 80 mẫu
2025-04-26 00:38:40,177 - preprocess - INFO - Tập kiểm tra: 20 mẫu
2025-04-26 00:38:40,182 - preprocess - INFO - Đã lưu tập huấn luyện: C:\Users\trant\AppData\Local\Temp\autobkp_test_6n0w5bih\test_customer_train_20250426_003840.csv
2025-04-26 00:38:40,182 - preprocess - INFO - Đã lưu tập kiểm tra: C:\Users\trant\AppData\Local\Temp\autobkp_test_6n0w5bih\test_customer_test_20250426_003840.csv
2025-04-26 00:38:40,183 - app.config.utils - INFO - Đã lưu metadata tại: C:\Users\trant\AppData\Local\Temp\autobkp_test_6n0w5bih\test_customer_metadata_20250426_003840.json
2025-04-26 00:38:40,183 - preprocess - INFO - Đã lưu metadata: C:\Users\trant\AppData\Local\Temp\autobkp_test_6n0w5bih\test_customer_metadata_20250426_003840.json
2025-04-26 00:38:40,183 - test_autobkp - INFO - Đã tiền xử lý dữ liệu thành công
2025-04-26 00:38:40,184 - test_autobkp - INFO - - Tập huấn luyện: C:\Users\trant\AppData\Local\Temp\autobkp_test_6n0w5bih\test_customer_train_20250426_003840.csv
2025-04-26 00:38:40,184 - test_autobkp - INFO - - Tập kiểm tra: C:\Users\trant\AppData\Local\Temp\autobkp_test_6n0w5bih\test_customer_test_20250426_003840.csv
2025-04-26 00:38:40,238 - test_autobkp - INFO - Số lượng mẫu trong tập huấn luyện: 80
2025-04-26 00:38:40,239 - test_autobkp - INFO - Số lượng mẫu trong tập kiểm tra: 20
2025-04-26 00:38:40,239 - test_autobkp - INFO - Kiểm tra chức năng tiền xử lý dữ liệu thành công
2025-04-26 00:38:40,239 - test_autobkp - INFO - ✓ Kiểm tra chức năng tiền xử lý thành công
2025-04-26 00:38:40,240 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng huấn luyện mô hình...
2025-04-26 00:38:40,240 - train - INFO - Bắt đầu huấn luyện mô hình cho khách hàng test_customer
2025-04-26 00:38:40,242 - train - INFO - Đã đọc 80 dòng dữ liệu huấn luyện từ C:\Users\trant\AppData\Local\Temp\autobkp_test_6n0w5bih\test_customer_train_20250426_003840.csv
2025-04-26 00:38:40,243 - train - INFO - Đã đọc 20 dòng dữ liệu kiểm tra từ C:\Users\trant\AppData\Local\Temp\autobkp_test_6n0w5bih\test_customer_test_20250426_003840.csv
2025-04-26 00:38:40,244 - train - INFO - Bắt đầu huấn luyện mô hình HachToan cho khách hàng test_customer
2025-04-26 00:38:40,244 - train - INFO - Tiền xử lý dữ liệu...
2025-04-26 00:38:40,247 - train - INFO - Tạo feature extractor...
2025-04-26 00:38:40,247 - app.utils.feature_extraction - WARNING - Không tìm thấy thư viện xử lý tiếng Việt (underthesea, pyvi). Chức năng xử lý tiếng Việt sẽ bị hạn chế.
2025-04-26 00:38:40,247 - train - INFO - Trích xuất đặc trưng...
2025-04-26 00:38:40,249 - train - ERROR - Lỗi khi huấn luyện mô hình: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\Python\AutoBKP_V2\app\scripts\train.py", line 1641, in train_customer_model
    trainer.train_hachtoan_model(train_df)
  File "D:\Python\AutoBKP_V2\app\scripts\train.py", line 442, in train_hachtoan_model
    X_transformed = self.feature_extractor.fit_transform(X)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\app\utils\feature_extraction.py", line 232, in fit_transform
    return self.fit(df, y).transform(df)
           ^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\app\utils\feature_extraction.py", line 199, in fit
    self.column_transformer.fit(df)
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 947, in fit
    self.fit_transform(X, y=y, **params)
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 1001, in fit_transform
    result = self._call_func_on_transformers(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 910, in _call_func_on_transformers
    return Parallel(n_jobs=self.n_jobs)(jobs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\sklearn\utils\parallel.py", line 77, in __call__
    return super().__call__(iterable_with_config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\joblib\parallel.py", line 1918, in __call__
    return output if self.return_generator else list(output)
                                                ^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\joblib\parallel.py", line 1847, in _get_sequential_output
    res = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\sklearn\utils\parallel.py", line 139, in __call__
    return self.function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\sklearn\pipeline.py", line 1551, in _fit_transform_one
    res = transformer.fit_transform(X, y, **params.get("fit_transform", {}))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\sklearn\pipeline.py", line 718, in fit_transform
    Xt = self._fit(X, y, routed_params)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\sklearn\pipeline.py", line 588, in _fit
    X, fitted_transformer = fit_transform_one_cached(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\joblib\memory.py", line 312, in __call__
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\sklearn\pipeline.py", line 1551, in _fit_transform_one
    res = transformer.fit_transform(X, y, **params.get("fit_transform", {}))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\sklearn\base.py", line 918, in fit_transform
    return self.fit(X, **fit_params).transform(X)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\sklearn\preprocessing\_function_transformer.py", line 260, in transform
    out = self._transform(X, func=self.func, kw_args=self.kw_args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\sklearn\preprocessing\_function_transformer.py", line 387, in _transform
    return func(X, **(kw_args if kw_args else {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\app\utils\feature_extraction.py", line 86, in _preprocess_vietnamese_text
    return "" if pd.isna(text) else str(text)
                 ^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-26 00:38:40,477 - test_autobkp - ERROR - Lỗi khi huấn luyện mô hình: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-26 00:38:40,478 - test_autobkp - ERROR - ✗ Kiểm tra chức năng huấn luyện thất bại
2025-04-26 00:38:40,478 - test_autobkp - WARNING - Dừng các bài kiểm tra tiếp theo
2025-04-26 00:42:01,280 - config_manager - INFO - Đã tải cấu hình mặc định
2025-04-26 00:42:02,379 - test_autobkp - INFO - Đã khởi tạo AutoBKPTester với customer_id: test_customer
2025-04-26 00:42:02,379 - test_autobkp - INFO - Thư mục tạm: C:\Users\trant\AppData\Local\Temp\autobkp_test_n82wbehm
2025-04-26 00:42:02,379 - test_autobkp - INFO - === BẮT ĐẦU CHẠY TẤT CẢ CÁC BÀI KIỂM TRA ===
2025-04-26 00:42:02,379 - test_autobkp - INFO - Bắt đầu kiểm tra cấu hình...
2025-04-26 00:42:02,380 - test_autobkp - INFO - Đã tải cấu hình mặc định thành công
2025-04-26 00:42:02,380 - test_autobkp - INFO - Đã tải cấu hình khách hàng test_customer thành công
2025-04-26 00:42:02,380 - test_autobkp - INFO - Kiểm tra cấu hình thành công
2025-04-26 00:42:02,380 - test_autobkp - INFO - ✓ Kiểm tra cấu hình thành công
2025-04-26 00:42:02,380 - test_autobkp - INFO - Bắt đầu tạo 100 dòng dữ liệu mẫu...
2025-04-26 00:42:02,383 - test_autobkp - INFO - Đã tạo dữ liệu mẫu và lưu vào: C:\Users\trant\AppData\Local\Temp\autobkp_test_n82wbehm\test_customer_sample_data.csv
2025-04-26 00:42:02,383 - test_autobkp - INFO - ✓ Tạo dữ liệu mẫu thành công
2025-04-26 00:42:02,383 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng validate_data...
2025-04-26 00:42:02,383 - validate_data - INFO - Bắt đầu kiểm tra tính hợp lệ của dữ liệu từ file C:\Users\trant\AppData\Local\Temp\autobkp_test_n82wbehm\test_customer_sample_data.csv
2025-04-26 00:42:02,412 - validate_data - INFO - Đã đọc file CSV với encoding utf-8
2025-04-26 00:42:02,416 - validate_data - INFO - Hoàn tất kiểm tra. Trạng thái: warnings
2025-04-26 00:42:02,416 - validate_data - INFO - Tổng số cảnh báo: 1
2025-04-26 00:42:02,417 - test_autobkp - INFO - Kết quả validate: warnings
2025-04-26 00:42:02,417 - test_autobkp - INFO - Đã lưu kết quả validate vào: C:\Users\trant\AppData\Local\Temp\autobkp_test_n82wbehm\validate_result.json
2025-04-26 00:42:02,418 - test_autobkp - WARNING - Tìm thấy 1 cảnh báo trong dữ liệu
2025-04-26 00:42:02,418 - test_autobkp - WARNING - - Class imbalance detected in primary target (severity: medium)
2025-04-26 00:42:02,418 - test_autobkp - INFO - Kiểm tra chức năng validate_data thành công
2025-04-26 00:42:02,418 - test_autobkp - INFO - ✓ Kiểm tra chức năng validate_data thành công
2025-04-26 00:42:02,418 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng tiền xử lý dữ liệu...
2025-04-26 00:42:02,418 - preprocess - INFO - Bắt đầu tiền xử lý dữ liệu cho khách hàng test_customer
2025-04-26 00:42:02,419 - preprocess - INFO - Đọc dữ liệu từ: C:\Users\trant\AppData\Local\Temp\autobkp_test_n82wbehm\test_customer_sample_data.csv
2025-04-26 00:42:02,420 - preprocess - INFO - Đọc thành công với encoding: utf-8
2025-04-26 00:42:02,420 - preprocess - INFO - Đã đọc 100 dòng dữ liệu từ C:\Users\trant\AppData\Local\Temp\autobkp_test_n82wbehm\test_customer_sample_data.csv
2025-04-26 00:42:02,421 - preprocess - INFO - Tiền xử lý cột văn bản tiếng Việt: TenHangHoaDichVu
2025-04-26 00:42:02,422 - preprocess - INFO - Tiền xử lý cột ID: MSTNguoiBan
2025-04-26 00:42:02,423 - preprocess - INFO - Phân tích phân phối của biến mục tiêu: HachToan
2025-04-26 00:42:02,424 - preprocess - INFO - Số lượng lớp: 15
2025-04-26 00:42:02,424 - preprocess - INFO - Tỷ lệ mất cân bằng: 12.00
2025-04-26 00:42:02,424 - preprocess - INFO - Lớp hiếm nhất có 1 mẫu (1.00%)
2025-04-26 00:42:02,424 - preprocess - INFO - Lớp phổ biến nhất có 12 mẫu (12.00%)
2025-04-26 00:42:02,424 - preprocess - INFO - Phân tích phân phối của biến mục tiêu: MaHangHoa
2025-04-26 00:42:02,425 - preprocess - INFO - Số lượng lớp: 9
2025-04-26 00:42:02,425 - preprocess - INFO - Tỷ lệ mất cân bằng: 5.00
2025-04-26 00:42:02,425 - preprocess - INFO - Lớp hiếm nhất có 1 mẫu (3.57%)
2025-04-26 00:42:02,425 - preprocess - INFO - Lớp phổ biến nhất có 5 mẫu (17.86%)
2025-04-26 00:42:02,425 - preprocess - INFO - Phân chia dữ liệu với test_size=0.2
2025-04-26 00:42:02,426 - preprocess - INFO - Tập huấn luyện: 80 mẫu
2025-04-26 00:42:02,426 - preprocess - INFO - Tập kiểm tra: 20 mẫu
2025-04-26 00:42:02,436 - preprocess - INFO - Đã lưu tập huấn luyện: C:\Users\trant\AppData\Local\Temp\autobkp_test_n82wbehm\test_customer_train_20250426_004202.csv
2025-04-26 00:42:02,436 - preprocess - INFO - Đã lưu tập kiểm tra: C:\Users\trant\AppData\Local\Temp\autobkp_test_n82wbehm\test_customer_test_20250426_004202.csv
2025-04-26 00:42:02,436 - app.config.utils - INFO - Đã lưu metadata tại: C:\Users\trant\AppData\Local\Temp\autobkp_test_n82wbehm\test_customer_metadata_20250426_004202.json
2025-04-26 00:42:02,437 - preprocess - INFO - Đã lưu metadata: C:\Users\trant\AppData\Local\Temp\autobkp_test_n82wbehm\test_customer_metadata_20250426_004202.json
2025-04-26 00:42:02,437 - test_autobkp - INFO - Đã tiền xử lý dữ liệu thành công
2025-04-26 00:42:02,437 - test_autobkp - INFO - - Tập huấn luyện: C:\Users\trant\AppData\Local\Temp\autobkp_test_n82wbehm\test_customer_train_20250426_004202.csv
2025-04-26 00:42:02,437 - test_autobkp - INFO - - Tập kiểm tra: C:\Users\trant\AppData\Local\Temp\autobkp_test_n82wbehm\test_customer_test_20250426_004202.csv
2025-04-26 00:42:02,470 - test_autobkp - INFO - Số lượng mẫu trong tập huấn luyện: 80
2025-04-26 00:42:02,471 - test_autobkp - INFO - Số lượng mẫu trong tập kiểm tra: 20
2025-04-26 00:42:02,472 - test_autobkp - INFO - Kiểm tra chức năng tiền xử lý dữ liệu thành công
2025-04-26 00:42:02,472 - test_autobkp - INFO - ✓ Kiểm tra chức năng tiền xử lý thành công
2025-04-26 00:42:02,472 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng huấn luyện mô hình...
2025-04-26 00:42:02,472 - train - INFO - Bắt đầu huấn luyện mô hình cho khách hàng test_customer
2025-04-26 00:42:02,474 - train - INFO - Đã đọc 80 dòng dữ liệu huấn luyện từ C:\Users\trant\AppData\Local\Temp\autobkp_test_n82wbehm\test_customer_train_20250426_004202.csv
2025-04-26 00:42:02,475 - train - INFO - Đã đọc 20 dòng dữ liệu kiểm tra từ C:\Users\trant\AppData\Local\Temp\autobkp_test_n82wbehm\test_customer_test_20250426_004202.csv
2025-04-26 00:42:02,476 - train - INFO - Bắt đầu huấn luyện mô hình HachToan cho khách hàng test_customer
2025-04-26 00:42:02,476 - train - INFO - Tiền xử lý dữ liệu...
2025-04-26 00:42:02,478 - train - INFO - Tạo feature extractor...
2025-04-26 00:42:02,478 - app.utils.feature_extraction - WARNING - Không tìm thấy thư viện xử lý tiếng Việt (underthesea, pyvi). Chức năng xử lý tiếng Việt sẽ bị hạn chế.
2025-04-26 00:42:02,479 - train - INFO - Trích xuất đặc trưng...
2025-04-26 00:42:02,484 - app.utils.feature_extraction - WARNING - Lỗi khi lấy tên đặc trưng từ transformer text_TenHangHoaDichVu: Estimator preprocess does not provide get_feature_names_out. Did you mean to call pipeline[:-1].get_feature_names_out()?
2025-04-26 00:42:02,488 - train - INFO - Đã trích xuất 177 đặc trưng
2025-04-26 00:42:02,489 - train - INFO - Xử lý mất cân bằng dữ liệu với chiến lược: auto
2025-04-26 00:42:02,489 - train - INFO - Đã tự động chọn chiến lược: smote
2025-04-26 00:42:03,686 - train - ERROR - Lỗi khi xử lý mất cân bằng: Expected n_neighbors <= n_samples_fit, but n_neighbors = 6, n_samples_fit = 4, n_samples = 4
2025-04-26 00:42:03,686 - train - WARNING - Sử dụng dữ liệu gốc mà không xử lý mất cân bằng
2025-04-26 00:42:03,687 - train - INFO - Tạo mô hình xgboost cho hachtoan_model
2025-04-26 00:42:03,827 - train - INFO - Đã tạo mô hình XGBoost với tham số: {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'objective': 'multi:softprob', 'n_jobs': -1, 'random_state': 42}
2025-04-26 00:42:03,827 - train - INFO - Huấn luyện mô hình...
2025-04-26 00:42:03,829 - train - ERROR - Lỗi khi huấn luyện mô hình: Invalid classes inferred from unique values of `y`.  Expected: [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14], got [1561 1562 1563 1564 1565 2111 2112 2113 2114 2115 3331 3332 3333 3334
 3335]
Traceback (most recent call last):
  File "D:\Python\AutoBKP_V2\app\scripts\train.py", line 1641, in train_customer_model
    trainer.train_hachtoan_model(train_df)
  File "D:\Python\AutoBKP_V2\app\scripts\train.py", line 464, in train_hachtoan_model
    classifier.fit(X_balanced, y_balanced)
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\xgboost\core.py", line 729, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\xgboost\sklearn.py", line 1640, in fit
    raise ValueError(
ValueError: Invalid classes inferred from unique values of `y`.  Expected: [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14], got [1561 1562 1563 1564 1565 2111 2112 2113 2114 2115 3331 3332 3333 3334
 3335]
2025-04-26 00:42:03,854 - test_autobkp - ERROR - Lỗi khi huấn luyện mô hình: Invalid classes inferred from unique values of `y`.  Expected: [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14], got [1561 1562 1563 1564 1565 2111 2112 2113 2114 2115 3331 3332 3333 3334
 3335]
2025-04-26 00:42:03,854 - test_autobkp - ERROR - ✗ Kiểm tra chức năng huấn luyện thất bại
2025-04-26 00:42:03,854 - test_autobkp - WARNING - Dừng các bài kiểm tra tiếp theo
2025-04-26 00:53:26,340 - config_manager - INFO - Đã tải cấu hình mặc định
2025-04-26 00:53:27,415 - test_autobkp - INFO - Đã khởi tạo AutoBKPTester với customer_id: test_customer
2025-04-26 00:53:27,415 - test_autobkp - INFO - Thư mục tạm: C:\Users\trant\AppData\Local\Temp\autobkp_test_r037_w3l
2025-04-26 00:53:27,415 - test_autobkp - INFO - === BẮT ĐẦU CHẠY TẤT CẢ CÁC BÀI KIỂM TRA ===
2025-04-26 00:53:27,416 - test_autobkp - INFO - Bắt đầu kiểm tra cấu hình...
2025-04-26 00:53:27,416 - test_autobkp - INFO - Đã tải cấu hình mặc định thành công
2025-04-26 00:53:27,416 - test_autobkp - INFO - Đã tải cấu hình khách hàng test_customer thành công
2025-04-26 00:53:27,416 - test_autobkp - INFO - Kiểm tra cấu hình thành công
2025-04-26 00:53:27,416 - test_autobkp - INFO - ✓ Kiểm tra cấu hình thành công
2025-04-26 00:53:27,416 - test_autobkp - INFO - Bắt đầu tạo 100 dòng dữ liệu mẫu...
2025-04-26 00:53:27,419 - test_autobkp - INFO - Đã tạo dữ liệu mẫu và lưu vào: C:\Users\trant\AppData\Local\Temp\autobkp_test_r037_w3l\test_customer_sample_data.csv
2025-04-26 00:53:27,419 - test_autobkp - INFO - ✓ Tạo dữ liệu mẫu thành công
2025-04-26 00:53:27,419 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng validate_data...
2025-04-26 00:53:27,419 - validate_data - INFO - Bắt đầu kiểm tra tính hợp lệ của dữ liệu từ file C:\Users\trant\AppData\Local\Temp\autobkp_test_r037_w3l\test_customer_sample_data.csv
2025-04-26 00:53:27,446 - validate_data - INFO - Đã đọc file CSV với encoding utf-8
2025-04-26 00:53:27,450 - validate_data - INFO - Hoàn tất kiểm tra. Trạng thái: valid
2025-04-26 00:53:27,450 - validate_data - INFO - Tổng số cảnh báo: 0
2025-04-26 00:53:27,450 - test_autobkp - INFO - Kết quả validate: valid
2025-04-26 00:53:27,453 - test_autobkp - INFO - Đã lưu kết quả validate vào: C:\Users\trant\AppData\Local\Temp\autobkp_test_r037_w3l\validate_result.json
2025-04-26 00:53:27,453 - test_autobkp - INFO - Kiểm tra chức năng validate_data thành công
2025-04-26 00:53:27,453 - test_autobkp - INFO - ✓ Kiểm tra chức năng validate_data thành công
2025-04-26 00:53:27,453 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng tiền xử lý dữ liệu...
2025-04-26 00:53:27,454 - preprocess - INFO - Bắt đầu tiền xử lý dữ liệu cho khách hàng test_customer
2025-04-26 00:53:27,454 - preprocess - INFO - Đọc dữ liệu từ: C:\Users\trant\AppData\Local\Temp\autobkp_test_r037_w3l\test_customer_sample_data.csv
2025-04-26 00:53:27,456 - preprocess - INFO - Đọc thành công với encoding: utf-8
2025-04-26 00:53:27,456 - preprocess - INFO - Đã đọc 100 dòng dữ liệu từ C:\Users\trant\AppData\Local\Temp\autobkp_test_r037_w3l\test_customer_sample_data.csv
2025-04-26 00:53:27,457 - preprocess - INFO - Tiền xử lý cột văn bản tiếng Việt: TenHangHoaDichVu
2025-04-26 00:53:27,458 - preprocess - INFO - Tiền xử lý cột ID: MSTNguoiBan
2025-04-26 00:53:27,459 - preprocess - INFO - Phân tích phân phối của biến mục tiêu: HachToan
2025-04-26 00:53:27,459 - preprocess - INFO - Số lượng lớp: 15
2025-04-26 00:53:27,459 - preprocess - INFO - Tỷ lệ mất cân bằng: 8.00
2025-04-26 00:53:27,459 - preprocess - INFO - Lớp hiếm nhất có 2 mẫu (2.00%)
2025-04-26 00:53:27,459 - preprocess - INFO - Lớp phổ biến nhất có 16 mẫu (16.00%)
2025-04-26 00:53:27,460 - preprocess - INFO - Phân tích phân phối của biến mục tiêu: MaHangHoa
2025-04-26 00:53:27,460 - preprocess - INFO - Số lượng lớp: 9
2025-04-26 00:53:27,460 - preprocess - INFO - Tỷ lệ mất cân bằng: 7.00
2025-04-26 00:53:27,460 - preprocess - INFO - Lớp hiếm nhất có 1 mẫu (2.94%)
2025-04-26 00:53:27,460 - preprocess - INFO - Lớp phổ biến nhất có 7 mẫu (20.59%)
2025-04-26 00:53:27,460 - preprocess - INFO - Phân chia dữ liệu với test_size=0.2
2025-04-26 00:53:27,461 - preprocess - INFO - Tập huấn luyện: 80 mẫu
2025-04-26 00:53:27,461 - preprocess - INFO - Tập kiểm tra: 20 mẫu
2025-04-26 00:53:27,472 - preprocess - INFO - Đã lưu tập huấn luyện: C:\Users\trant\AppData\Local\Temp\autobkp_test_r037_w3l\test_customer_train_20250426_005327.csv
2025-04-26 00:53:27,473 - preprocess - INFO - Đã lưu tập kiểm tra: C:\Users\trant\AppData\Local\Temp\autobkp_test_r037_w3l\test_customer_test_20250426_005327.csv
2025-04-26 00:53:27,474 - app.config.utils - INFO - Đã lưu metadata tại: C:\Users\trant\AppData\Local\Temp\autobkp_test_r037_w3l\test_customer_metadata_20250426_005327.json
2025-04-26 00:53:27,474 - preprocess - INFO - Đã lưu metadata: C:\Users\trant\AppData\Local\Temp\autobkp_test_r037_w3l\test_customer_metadata_20250426_005327.json
2025-04-26 00:53:27,474 - test_autobkp - INFO - Đã tiền xử lý dữ liệu thành công
2025-04-26 00:53:27,474 - test_autobkp - INFO - - Tập huấn luyện: C:\Users\trant\AppData\Local\Temp\autobkp_test_r037_w3l\test_customer_train_20250426_005327.csv
2025-04-26 00:53:27,474 - test_autobkp - INFO - - Tập kiểm tra: C:\Users\trant\AppData\Local\Temp\autobkp_test_r037_w3l\test_customer_test_20250426_005327.csv
2025-04-26 00:53:27,516 - test_autobkp - INFO - Số lượng mẫu trong tập huấn luyện: 80
2025-04-26 00:53:27,517 - test_autobkp - INFO - Số lượng mẫu trong tập kiểm tra: 20
2025-04-26 00:53:27,517 - test_autobkp - INFO - Kiểm tra chức năng tiền xử lý dữ liệu thành công
2025-04-26 00:53:27,518 - test_autobkp - INFO - ✓ Kiểm tra chức năng tiền xử lý thành công
2025-04-26 00:53:27,518 - test_autobkp - INFO - Bắt đầu kiểm tra chức năng huấn luyện mô hình...
2025-04-26 00:53:27,518 - train - INFO - Bắt đầu huấn luyện mô hình cho khách hàng test_customer
2025-04-26 00:53:27,519 - train - INFO - Đã đọc 80 dòng dữ liệu huấn luyện từ C:\Users\trant\AppData\Local\Temp\autobkp_test_r037_w3l\test_customer_train_20250426_005327.csv
2025-04-26 00:53:27,520 - train - INFO - Đã đọc 20 dòng dữ liệu kiểm tra từ C:\Users\trant\AppData\Local\Temp\autobkp_test_r037_w3l\test_customer_test_20250426_005327.csv
2025-04-26 00:53:27,522 - train - INFO - Bắt đầu huấn luyện mô hình HachToan cho khách hàng test_customer
2025-04-26 00:53:27,522 - train - INFO - Tiền xử lý dữ liệu...
2025-04-26 00:53:27,523 - train - INFO - Tạo feature extractor...
2025-04-26 00:53:27,523 - app.utils.feature_extraction - WARNING - Không tìm thấy thư viện xử lý tiếng Việt (underthesea, pyvi). Chức năng xử lý tiếng Việt sẽ bị hạn chế.
2025-04-26 00:53:27,525 - train - INFO - Trích xuất đặc trưng...
2025-04-26 00:53:27,530 - app.utils.feature_extraction - WARNING - Lỗi khi lấy tên đặc trưng từ transformer text_TenHangHoaDichVu: Estimator preprocess does not provide get_feature_names_out. Did you mean to call pipeline[:-1].get_feature_names_out()?
2025-04-26 00:53:27,534 - train - INFO - Đã trích xuất 181 đặc trưng
2025-04-26 00:53:27,535 - train - INFO - Xử lý mất cân bằng dữ liệu với chiến lược: auto
2025-04-26 00:53:27,535 - train - INFO - Đã tự động chọn chiến lược: smote
2025-04-26 00:53:27,749 - train - WARNING - Không đủ mẫu cho SMOTE (min_samples=0 < 6), sử dụng RandomOverSampler
2025-04-26 00:53:27,752 - train - INFO - Đã xử lý mất cân bằng: 80 -> 165 mẫu
2025-04-26 00:53:27,752 - train - INFO - Tạo mô hình xgboost cho hachtoan_model
2025-04-26 00:53:27,774 - train - INFO - Đã tạo mô hình XGBoost với tham số: {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'objective': 'multi:softprob', 'n_jobs': -1, 'random_state': 42}
2025-04-26 00:53:27,774 - train - INFO - Huấn luyện mô hình...
2025-04-26 00:53:27,775 - train - ERROR - Lỗi khi huấn luyện mô hình: Invalid classes inferred from unique values of `y`.  Expected: [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14], got [1561 1562 1563 1564 1565 2111 2112 2113 2114 2115 3331 3332 3333 3334
 3335]
Traceback (most recent call last):
  File "D:\Python\AutoBKP_V2\app\scripts\train.py", line 1658, in train_customer_model
    trainer.train_hachtoan_model(train_df)
  File "D:\Python\AutoBKP_V2\app\scripts\train.py", line 476, in train_hachtoan_model
    classifier.fit(X_balanced, y_balanced)
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\xgboost\core.py", line 729, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "D:\Python\AutoBKP_V2\.venv\Lib\site-packages\xgboost\sklearn.py", line 1640, in fit
    raise ValueError(
ValueError: Invalid classes inferred from unique values of `y`.  Expected: [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14], got [1561 1562 1563 1564 1565 2111 2112 2113 2114 2115 3331 3332 3333 3334
 3335]
2025-04-26 00:53:27,777 - test_autobkp - ERROR - Lỗi khi huấn luyện mô hình: Invalid classes inferred from unique values of `y`.  Expected: [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14], got [1561 1562 1563 1564 1565 2111 2112 2113 2114 2115 3331 3332 3333 3334
 3335]
2025-04-26 00:53:27,777 - test_autobkp - ERROR - ✗ Kiểm tra chức năng huấn luyện thất bại
2025-04-26 00:53:27,777 - test_autobkp - WARNING - Dừng các bài kiểm tra tiếp theo
